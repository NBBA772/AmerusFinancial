{"version":3,"file":"_id_-1e5qiMk2.js","sources":["../../../../pages/dashboard/question/[id].vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport DashboardSidebar from \"~~/components/elements/DashboardSidebar.vue\";\nimport AnswerForm from \"~/components/elements/AnswerForm.vue\";\nimport QuestionForm from \"~~/components/elements/QuestionForm.vue\";\nimport Tiptap from \"~~/components/elements/Tiptap.vue\";\n\nconst questionId = getParam(\"id\");\nconst me = await useUser();\nconst router = useRouter();\nconst route = useRoute();\nconst showEditForm = ref(false);\nconst showDeleted = ref(false);\nconst showAnswerButton = ref(false);\nlet isAdmin: boolean = true;\n\nconst isLoggedIn = await useLoggedIn();\n\nconst { data: question } = await useFetch<IQuestion>(\n  `/api/dashboard/question?id=${questionId}`,\n  { key: route.fullPath }\n);\n\nconst showAnswerForm = useState(\"showAnswerForm\" + questionId, () => false);\n\nconst isMine = question?.value?.authorId == me?.id;\n\nif (me?.id === 1) {\n  isAdmin = true;\n} else {\n  isAdmin = false;\n}\n\nasync function deleteQuestion() {\n  const { data: deleted } = await useFetch(\"/api/dashboard/delete-question\", {\n    method: \"POST\",\n    body: { questionId },\n  });\n\n  showDeleted.value = true;\n  setTimeout(() => {\n    router.push(\"/dashboard/search\");\n  });\n}\n\nconst editEndpoint = \"/api/dashboard/edit-question\";\n\nfunction addAnswer(answer: IAnswer) {\n  console.log(\"&&&&&&&&& add answer\");\n  question.value?.answers.push(answer);\n  showAnswerForm.value = false;\n}\n</script>\n \n <template>\n  <PatternSection>\n    <div class=\"h-32 flex justify-center\">\n      <div class=\"flex m-5\">\n        <!-- <img\n          class=\"mx-auto h-24 w-auto\"\n          src=\"/img/logo_clear_fsj.png\"\n          alt=\"full stack jack logo\"\n        /> -->\n        <h1\n          class=\"py-9 text-center text-5xl font-extrabold text-gray-900 dark:text-gray-400 ml-4\"\n        >\n          Questions\n        </h1>\n      </div>\n    </div>\n    <div class=\"md:flex min-h-full\">\n      <DashboardSidebar />\n      <div class=\"w-full z-1 justify-right relative\">\n        <div\n          class=\"p-8 text-white bg-lime-600 dark:bg-black rounded shadow-md\"\n          v-if=\"showDeleted\"\n        >\n          question deleted\n        </div>\n        <div\n          v-if=\"question\"\n          class=\"flex w-full flex-column justify-center transition duration-500\"\n        >\n          <div class=\"w-full p-4\">\n            <div class=\"p-8 bg-white dark:bg-gray-800 rounded shadow-md\">\n              <div class=\"flex justify-end dark:text-gray-300\">\n                {{ question.authName }}\n              </div>\n\n              <h2 class=\"text-2xl font-bold text-gray-800 dark:text-gray-300\">\n                {{ question.title }}\n              </h2>\n              <!-- <p class=\"dark:text-gray-300\">{{ question.description }}</p> -->\n\n              <Tiptap\n                v-if=\"!showEditForm\"\n                v-model=\"question.description\"\n                label=\"\"\n                :editable=\"false\"\n              />\n\n              <div class=\"mt-5\" v-if=\"isMine && showEditForm == false\">\n                <button\n                  @click=\"showEditForm = true\"\n                  class=\"bg-indigo-500 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded\"\n                >\n                  Edit\n                </button>\n                <button\n                  @click=\"deleteQuestion\"\n                  class=\"bg-red-500 ml-3 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded\"\n                >\n                  delete\n                </button>\n              </div>\n\n              <QuestionForm\n                :endpoint=\"editEndpoint\"\n                :data=\"question\"\n                v-if=\"showEditForm\"\n              />\n            </div>\n          </div>\n        </div>\n        <div\n          v-for=\"answer in question?.answers\"\n          :key=\"answer.id\"\n          class=\"flex flex-column justify-center hover:scale-110 transition duration-500\"\n        >\n          <div class=\"max-w-xxl w-full p-4\">\n            <div class=\"p-8 bg-white dark:bg-slate-900 rounded shadow-md\">\n              <div class=\"flex justify-end dark:text-gray-300\">\n                {{ answer.authorName }}\n              </div>\n              <p class=\"dark:text-gray-300\">{{ answer.text }}</p>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button\n            v-if=\"!showAnswerForm && isLoggedIn && isAdmin\"\n            @click=\"showAnswerForm = !showAnswerForm\"\n            type=\"button\"\n            class=\"dark:focus:ring-amber-800 bg-blue-400 hover:bg-blue-800 dark:bg-amber-500 dark:hover:bg-amber-600 font-medium text-sm rounded-lg px-5 py-2.5 mr-2 mb-2\"\n          >\n            Answer\n          </button>\n        </div>\n        <div v-if=\"showAnswerForm\">\n          <AnswerForm :questionId=\"questionId\" @addAnswer=\"addAnswer\" />\n        </div>\n      </div>\n    </div>\n  </PatternSection>\n</template>"],"names":["_withAsyncContext","_a"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA,MAAM,eAAe;;;;;;;AAtCf,UAAA,aAAa,SAAS,IAAI;AAChC,UAAM,MAAK,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,SAAQ;AACzB,UAAM,SAAS;AACf,UAAM,QAAQ;AACR,UAAA,eAAe,IAAI,KAAK;AACxB,UAAA,cAAc,IAAI,KAAK;AACJ,QAAI,KAAK;AAClC,QAAI,UAAmB;AAEvB,UAAM,cAAmB,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAA,aAAY;AAE/B,UAAA,EAAE,MAAM,cAAa,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM;AAAA,MAC/B,8BAA8B,UAAU;AAAA,MACxC,EAAE,KAAK,MAAM,SAAS;AAAA,MACxB;AAAA,IAAA,CAAA;AAEA,UAAM,iBAAiB,SAAS,mBAAmB,YAAY,MAAM,KAAK;AAE1E,UAAM,WAAS,0CAAU,UAAV,mBAAiB,cAAY,yBAAI;AAE5C,SAAA,yBAAI,QAAO,GAAG;AACN,gBAAA;AAAA,IAAA,OACL;AACK,gBAAA;AAAA,IACZ;AAEA,mBAAe,iBAAiB;AACJ,YAAM,SAAS,kCAAkC;AAAA,QACzE,QAAQ;AAAA,QACR,MAAM,EAAE,WAAW;AAAA,MACrB,GAAA,aAAC;AAED,kBAAY,QAAQ;AACpB,iBAAW,MAAM;AACf,eAAO,KAAK,mBAAmB;AAAA,MAAA,CAChC;AAAA,IACH;AAIA,aAAS,UAAU,QAAiB;;AAClC,cAAQ,IAAI,sBAAsB;AACzB,OAAAC,MAAA,SAAA,UAAA,gBAAAA,IAAO,QAAQ,KAAK;AAC7B,qBAAe,QAAQ;AAAA,IACzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}